---
title: 权限
date: 2024-04-02 05:20
tags:
  - 权限
categories:
  - Linux
---

---

![IMG_0838](https://illyber-images.oss-cn-chengdu.aliyuncs.com/202302112026308.png)

# chown命令
```shell
#chmod改变权限的三种方法
#chmod 命令的权限模式的格式是 [ugoa][+-=][perms]，也就是 [用户身份][赋予方式][权限] 的格式
#chmod [选项]... 模式[,模式]... 文件...
#1.用数字
chmod [-R] 644 a.txt	#每个数字对应所有者/所有组/访客。(421,rwx)
#2.用字母赋值
chmod [-R] u=rwx,g=rw,o=r a.txt	#ugo，对应user, group，other; 会覆盖原来的权限
#也可写成:
chmod [-R] u=rwx,g=rw-,o=r-- a.txt
#或:
chmod [-R] a=r a.txt	#a是all
#3.用字母添加移除
chmod [-R] u-x, g+w, o+r a.txt	#添加/移除权限

#suid与guid
如果希望设置suid，那么就将相应的权限位之前的那一位设置为4；
如果希望设置guid，那么就将相应的权限位之前的那一位设置为2；
如果希望两者都置位，那么将相应的权限位之前的那一位设置为4+2。
```

# 权限对目录的意义

修改目录本身的权限不用价 `-R`

- 读（r）：对目录有读（r）权限，代表可以**查看目录下的内容**，也就是可以**查看目录下有哪些子文件和子目录**。如果把权限对应到命令上，那么一旦对目录拥有了读（r）权限，就可以在目录下执行 **ls 命令**，查看目录下的内容。
- 写（w）：对目录有写（w）权限，代表可以**修改目录下的数据**，也就是可以在目录中**新建、删除、复制、剪切子文件或子目录**。如果把权限对应到命令上，那么一旦对目录拥有了写（w）权限，就可以在目录下执行 **touch、rm、cp、mv 命令**。**对目录来说，写（w）权限是最高权限。**
- 执行（x）：目录是不能运行的，那么对目录拥有执行（x）权限，就可以对目录执行 **cd 命令**，进入目录

# 权限介绍

```shell
[hepingfly@hepingfly ~]$ ll
总用量 40
-rw-rw-r--. 2 hepingfly hepingfly    0 2月  14 00:23 aa.txt
```

- 第 1 位代表文件类型

- - “-” 表示文件
  - “d” 表示目录
  - “l” 表示软链接

- 第 2~4 位表示文件所有者的权限

- - r：代表 read ，是读权限
  - w：代表 write，是写权限
  - x：代表 excute，是执行权限

- 第 5~7 位表示文件所属组的权限

- 第 8~10位表示其他人的权限

- 在权限位后面还有一个 “.” 这个点表示该文件受 SELinux 的保护，SELinux 是美国国家安全局开发的一个增强 linux 安全组件

# suid与guid

![img](https://illyber-images.oss-cn-chengdu.aliyuncs.com/202301281946411.png)

- suid(s)意味着如果某个用户对属于自己的shell脚本设置了这种权限，那么其他用户在执行这一脚本时也会具有其属主的相应权限。

- guid(t)则表示执行相应脚本的用户将具有该文件所属用户组中用户的权限。

![image-20230122211436496](https://illyber-images.oss-cn-chengdu.aliyuncs.com/202301281946412.png)

# umask & fmask & dmask

# umask

umask 设置权限掩码(mask)，用于设置默认文件权限；
默认文件权限：`666-mask`
默认目录权限：`777-mask`；因为目录需要被打开，所以要多1(即x)
设置当前的mask值：`umask <mask>`
查看当前目录的权限mask值：`umask`
Linux下的etc/profile和etc/bashrc中都有默认的umask设置。如果实在etc/profile中修改，只有在重新登录用户的时候才会发生改变，而在etc/bashrc中修改的话要是切换目录就会发生改变，因为profile是在登录用户的时候调用的，而bashrc是在打开一个shell时候调用。

# fmask & dmask

fmask —— 设置文件的权限过滤  
dmask —— 设置目录的权限过滤  
dmask和fmask是mount的选项，针对fat/ntfs文件系统，适用于fstab配置（linux的/etc/fstab 文件，Android中没有）




---
